<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharan Car Rental - Premium Vehicle Rentals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC30TcmMVhP_8HdFYS1WufRiZwSDYNMTF0&libraries=geometry"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .hero-gradient {
            background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
        }
        .car-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .car-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .price-badge {
            background: #3b82f6;
        }
        .booking-form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="flex items-center space-x-3">
                        <div class="text-blue-600">
                            <svg class="w-10 h-10" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">SHARAN</h1>
                            <p class="text-xs text-gray-500 -mt-1">Car Rental</p>
                        </div>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#home" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Home</a>
                        <a href="#cars" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Our Fleet</a>
                        <a href="#pricing" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">Pricing</a>
                        <a href="#booking" class="bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700">Book Now</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-gradient text-white pt-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
            <div class="text-center">
                <h2 class="text-4xl md:text-6xl font-bold mb-6">Premium Car Rentals</h2>
                <p class="text-xl md:text-2xl mb-8 opacity-90">Experience luxury and comfort with our premium fleet</p>
                <a href="#cars" class="bg-white text-blue-600 px-8 py-3 rounded-full text-lg font-semibold hover:bg-gray-100 transition duration-300">Explore Our Fleet</a>
            </div>
        </div>
    </section>

    <!-- Car Fleet Section -->
    <section id="cars" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h3 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">Our Premium Fleet</h3>
                <p class="text-lg text-gray-600">Choose from our collection of luxury and premium vehicles</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="carGrid">
                <!-- Cars will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section id="pricing" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h3 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">Rental Packages</h3>
                <p class="text-lg text-gray-600">Choose the package that suits your needs</p>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full bg-white rounded-lg shadow-lg overflow-hidden">
                    <thead class="bg-blue-600 text-white">
                        <tr>
                            <th class="px-6 py-4 text-left">Vehicle</th>
                            <th class="px-6 py-4 text-center">1-Day Rent</th>
                            <th class="px-6 py-4 text-center">15-Day Package</th>
                            <th class="px-6 py-4 text-center">30-Day Package</th>
                            <th class="px-6 py-4 text-center">Savings</th>
                        </tr>
                    </thead>
                    <tbody id="pricingTable">
                        <!-- Pricing data will be loaded here -->
                    </tbody>
                </table>
            </div>
            <p class="text-center text-gray-600 mt-4">*All rates in INR | Fuel not included</p>
        </div>
    </section>

    <!-- Booking Section -->
    <section id="booking" class="py-20 hero-gradient">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h3 class="text-3xl md:text-4xl font-bold text-white mb-4">Book Your Ride</h3>
                <p class="text-lg text-white opacity-90">Fill out the form below to reserve your vehicle</p>
            </div>

            <div class="booking-form rounded-lg p-8 shadow-2xl">
                <form id="bookingForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" id="customerName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                            <input type="tel" id="customerPhone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" id="customerEmail" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Your Location/City</label>
                            <select id="customerLocation" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Select your city</option>
                                <option value="Banga">Banga</option>
                                <option value="Jalandhar">Jalandhar</option>
                                <option value="Hoshiarpur">Hoshiarpur</option>
                                <option value="Amritsar">Amritsar</option>
                                <option value="Other">Other (Check availability)</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Select Vehicle</label>
                            <select id="selectedCar" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Choose a vehicle</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Rental Package</label>
                            <select id="rentalPackage" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Select package</option>
                                <option value="1-day">1 Day</option>
                                <option value="15-day">15 Days</option>
                                <option value="30-day">30 Days</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                            <input type="date" id="startDate" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">End Date</label>
                            <input type="date" id="endDate" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Additional Requirements</label>
                        <textarea id="additionalNotes" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Any special requirements or notes..."></textarea>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="bg-blue-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-blue-700 transition duration-300 w-full md:w-auto">
                            Submit Booking Request
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h4 class="text-2xl font-bold mb-4">üöó Sharan Car Rental</h4>
                <p class="text-gray-400 mb-4">Premium car rental services for all your travel needs</p>
                <p class="text-gray-400">Contact us: +91 XXXXX XXXXX | info@sharancarrental.com</p>
            </div>
        </div>
    </footer>

    <!-- WhatsApp Floating Button -->
    <div class="fixed bottom-6 right-6 z-50">
        <a href="https://wa.me/917973418735" target="_blank" rel="noopener noreferrer" class="bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center">
            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
            </svg>
        </a>
    </div>

    <!-- Car Detail Modal -->
    <div id="carDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 id="carDetailTitle" class="text-2xl font-bold text-gray-800"></h3>
                    <button onclick="closeCarDetail()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Car Images -->
                    <div>
                        <div class="relative mb-4">
                            <img id="carDetailMainImage" src="" alt="" class="w-full h-64 object-cover rounded-lg" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                        </div>
                        <div id="carDetailThumbnails" class="flex space-x-2 overflow-x-auto">
                            <!-- Thumbnails will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Car Details -->
                    <div>
                        <div class="space-y-4">
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-800 mb-2">Pricing Details</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>1-Day Rent:</span>
                                        <span id="carDetail1Day" class="font-semibold"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>15-Day Package:</span>
                                        <span id="carDetail15Day" class="font-semibold"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>30-Day Package:</span>
                                        <span id="carDetail30Day" class="font-semibold"></span>
                                    </div>
                                    <div class="flex justify-between text-green-600">
                                        <span>Potential Savings:</span>
                                        <span id="carDetailSavings" class="font-semibold"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-800 mb-2">Check Availability & Price</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
                                        <input type="date" id="checkStartDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="calculatePrice()">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">End Date</label>
                                        <input type="date" id="checkEndDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="calculatePrice()">
                                    </div>
                                    <div id="priceCalculation" class="bg-white p-3 rounded border hidden">
                                        <div class="text-sm space-y-1">
                                            <div class="flex justify-between">
                                                <span>Total Days:</span>
                                                <span id="totalDays" class="font-semibold"></span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span>Daily Rate:</span>
                                                <span id="dailyRateDisplay" class="font-semibold"></span>
                                            </div>
                                            <div class="flex justify-between border-t pt-1">
                                                <span class="font-semibold">Total Cost:</span>
                                                <span id="totalCost" class="font-bold text-blue-600"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <button onclick="checkAvailability()" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
                                        Check Availability
                                    </button>
                                    <div id="availabilityResult" class="text-center font-semibold"></div>
                                </div>
                            </div>
                            
                            <div class="bg-yellow-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-800 mb-2">Service Areas</h4>
                                <p class="text-sm text-gray-600 mb-2">We provide rental services in:</p>
                                <div class="flex flex-wrap gap-2">
                                    <span class="bg-yellow-200 px-2 py-1 rounded text-xs">Banga</span>
                                    <span class="bg-yellow-200 px-2 py-1 rounded text-xs">Jalandhar</span>
                                    <span class="bg-yellow-200 px-2 py-1 rounded text-xs">Hoshiarpur</span>
                                    <span class="bg-yellow-200 px-2 py-1 rounded text-xs">Amritsar</span>
                                </div>
                                <button onclick="checkLocation()" class="mt-2 text-blue-600 text-sm hover:underline">
                                    üìç Check if we serve your area
                                </button>
                            </div>
                            
                            <button onclick="proceedToBooking()" id="proceedBookingBtn" class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 font-semibold disabled:bg-gray-400 disabled:cursor-not-allowed">
                                Proceed to Booking
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md mx-4">
            <div class="text-center">
                <div class="text-green-500 text-6xl mb-4">‚úÖ</div>
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Booking Submitted!</h3>
                <p class="text-gray-600 mb-6">Thank you for your booking request. We'll contact you shortly to confirm your reservation.</p>
                <button onclick="closeModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC30TcmMVhP_8HdFYS1WufRiZwSDYNMTF0",
            authDomain: "pulse2-92372.firebaseapp.com",
            databaseURL: "https://pulse2-92372-default-rtdb.firebaseio.com",
            projectId: "pulse2-92372",
            storageBucket: "pulse2-92372.firebasestorage.app",
            messagingSenderId: "276235725177",
            appId: "1:276235725177:web:0f4e0789fae80a435927a8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Service areas with coordinates
        const serviceAreas = {
            'Banga': { lat: 31.1881, lng: 75.9947 },
            'Jalandhar': { lat: 31.3260, lng: 75.5762 },
            'Hoshiarpur': { lat: 31.5204, lng: 75.9119 },
            'Amritsar': { lat: 31.6340, lng: 74.8723 }
        };

        let currentCarDetail = null;

        // Car data with multiple images
        const cars = [
            {
                id: 'audi-a7',
                name: 'Audi A7',
                color: 'White',
                images: ['https://pulse.oriontec.xyz/IMG_2844.jpeg'],
                dailyRate: 28000,
                package15: 320000,
                package30: 540000,
                savings: '‚Çπ3,00,000+'
            },
            {
                id: 'scorpio-n',
                name: 'Mahindra Scorpio-N',
                color: 'Black',
                images: ['https://pulse.oriontec.xyz/IMG_2845.jpeg'],
                dailyRate: 7000,
                package15: 85000,
                package30: 150000,
                savings: '‚Çπ60,000'
            },
            {
                id: 'fortuner-legender',
                name: 'Fortuner Legender',
                color: 'White',
                images: ['https://pulse.oriontec.xyz/IMG_2846.jpeg'],
                dailyRate: 12000,
                package15: 140000,
                package30: 240000,
                savings: '‚Çπ1,20,000'
            },
            {
                id: 'i20',
                name: 'Hyundai i20 (Top Variant)',
                color: 'White',
                images: ['https://pulse.oriontec.xyz/IMG_2847.jpeg'],
                dailyRate: 3000,
                package15: 35000,
                package30: 60000,
                savings: '‚Çπ30,000'
            },
            {
                id: 'fortuner-2019',
                name: 'Toyota Fortuner (2019)',
                color: 'White',
                images: [
                    'https://pulse.oriontec.xyz/IMG_9757.jpeg',
                    'https://pulse.oriontec.xyz/IMG_9758.jpeg',
                    'https://pulse.oriontec.xyz/IMG_9866.jpeg'
                ],
                dailyRate: 9000,
                package15: 105000,
                package30: 180000,
                savings: '‚Çπ90,000'
            },
            {
                id: 'range-rover',
                name: 'Range Rover Sport',
                color: 'Black',
                images: [
                    'https://pulse.oriontec.xyz/IMG_1892.jpeg',
                    'https://pulse.oriontec.xyz/IMG_2165.jpeg'
                ],
                dailyRate: 40000,
                package15: 460000,
                package30: 800000,
                savings: '‚Çπ4,00,000+'
            }
        ];

        // Load cars into the grid
        function loadCars() {
            const carGrid = document.getElementById('carGrid');
            const carSelect = document.getElementById('selectedCar');
            
            cars.forEach(car => {
                // Create car card
                const carCard = document.createElement('div');
                carCard.className = 'car-card bg-white rounded-lg shadow-lg overflow-hidden';
                
                // Create image carousel if multiple images
                let imageHTML = '';
                if (car.images.length > 1) {
                    imageHTML = `
                        <div class="relative">
                            <img src="${car.images[0]}" alt="${car.name}" class="w-full h-64 object-cover car-image-${car.id}" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                            <div class="absolute bottom-2 left-2 flex space-x-1">
                                ${car.images.map((img, index) => `
                                    <button onclick="changeImage('${car.id}', ${index})" class="w-2 h-2 rounded-full bg-white opacity-50 hover:opacity-100 ${index === 0 ? 'opacity-100' : ''}"></button>
                                `).join('')}
                            </div>
                        </div>
                    `;
                } else {
                    imageHTML = `<img src="${car.images[0]}" alt="${car.name}" class="w-full h-64 object-cover" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">`;
                }
                
                carCard.innerHTML = `
                    ${imageHTML}
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h4 class="text-xl font-bold text-gray-800">${car.name}</h4>
                                <p class="text-gray-600">${car.color}</p>
                            </div>
                            <div class="price-badge text-white px-3 py-1 rounded-full text-sm font-semibold">
                                ‚Çπ${car.dailyRate.toLocaleString()}/day
                            </div>
                        </div>
                        <div class="space-y-2 text-sm text-gray-600 mb-4">
                            <div class="flex justify-between">
                                <span>15-Day Package:</span>
                                <span class="font-semibold">‚Çπ${car.package15.toLocaleString()}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>30-Day Package:</span>
                                <span class="font-semibold">‚Çπ${car.package30.toLocaleString()}</span>
                            </div>
                            <div class="flex justify-between text-green-600">
                                <span>Savings:</span>
                                <span class="font-semibold">${car.savings}</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="showCarDetail('${car.id}')" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition duration-300">
                                View Details
                            </button>
                            <button onclick="selectCar('${car.id}')" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                Quick Book
                            </button>
                        </div>
                    </div>
                `;
                
                carGrid.appendChild(carCard);
                
                // Add to select dropdown
                const option = document.createElement('option');
                option.value = car.id;
                option.textContent = car.name;
                carSelect.appendChild(option);
            });
        }

        // Load pricing table
        function loadPricingTable() {
            const pricingTable = document.getElementById('pricingTable');
            
            cars.forEach((car, index) => {
                const row = document.createElement('tr');
                row.className = index % 2 === 0 ? 'bg-gray-50' : 'bg-white';
                row.innerHTML = `
                    <td class="px-6 py-4 font-medium text-gray-800">${car.name}</td>
                    <td class="px-6 py-4 text-center">‚Çπ${car.dailyRate.toLocaleString()}</td>
                    <td class="px-6 py-4 text-center">‚Çπ${car.package15.toLocaleString()}</td>
                    <td class="px-6 py-4 text-center">‚Çπ${car.package30.toLocaleString()}</td>
                    <td class="px-6 py-4 text-center text-green-600 font-semibold">${car.savings}</td>
                `;
                pricingTable.appendChild(row);
            });
        }

        // Change car image
        function changeImage(carId, imageIndex) {
            const car = cars.find(c => c.id === carId);
            const imgElement = document.querySelector(`.car-image-${carId}`);
            if (imgElement && car) {
                imgElement.src = car.images[imageIndex];
            }
        }

        // Show car detail modal
        function showCarDetail(carId) {
            const car = cars.find(c => c.id === carId);
            if (!car) return;
            
            currentCarDetail = car;
            
            // Update modal content
            document.getElementById('carDetailTitle').textContent = car.name + ' - ' + car.color;
            document.getElementById('carDetailMainImage').src = car.images[0];
            document.getElementById('carDetail1Day').textContent = '‚Çπ' + car.dailyRate.toLocaleString();
            document.getElementById('carDetail15Day').textContent = '‚Çπ' + car.package15.toLocaleString();
            document.getElementById('carDetail30Day').textContent = '‚Çπ' + car.package30.toLocaleString();
            document.getElementById('carDetailSavings').textContent = car.savings;
            
            // Load thumbnails
            const thumbnailsContainer = document.getElementById('carDetailThumbnails');
            thumbnailsContainer.innerHTML = '';
            car.images.forEach((img, index) => {
                const thumb = document.createElement('img');
                thumb.src = img;
                thumb.className = 'w-16 h-16 object-cover rounded cursor-pointer border-2 ' + (index === 0 ? 'border-blue-500' : 'border-gray-300');
                thumb.onclick = () => {
                    document.getElementById('carDetailMainImage').src = img;
                    thumbnailsContainer.querySelectorAll('img').forEach(t => t.className = t.className.replace('border-blue-500', 'border-gray-300'));
                    thumb.className = thumb.className.replace('border-gray-300', 'border-blue-500');
                };
                thumb.onerror = function() {
                    this.src = '';
                    this.alt = 'Image failed to load';
                    this.style.display = 'none';
                };
                thumbnailsContainer.appendChild(thumb);
            });
            
            // Set minimum dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('checkStartDate').min = today;
            document.getElementById('checkEndDate').min = today;
            
            // Show modal
            document.getElementById('carDetailModal').classList.remove('hidden');
            document.getElementById('carDetailModal').classList.add('flex');
        }

        // Close car detail modal
        function closeCarDetail() {
            document.getElementById('carDetailModal').classList.add('hidden');
            document.getElementById('carDetailModal').classList.remove('flex');
            currentCarDetail = null;
        }

        // Check availability
        function checkAvailability() {
            const startDate = document.getElementById('checkStartDate').value;
            const endDate = document.getElementById('checkEndDate').value;
            const resultDiv = document.getElementById('availabilityResult');
            
            if (!startDate || !endDate) {
                resultDiv.innerHTML = '<span class="text-red-600">Please select both dates</span>';
                return;
            }
            
            if (new Date(startDate) >= new Date(endDate)) {
                resultDiv.innerHTML = '<span class="text-red-600">End date must be after start date</span>';
                return;
            }
            
            // Check against existing bookings in Firebase
            const bookingsRef = database.ref('bookings');
            bookingsRef.orderByChild('selectedCar').equalTo(currentCarDetail.id).once('value', (snapshot) => {
                let isAvailable = true;
                const requestStart = new Date(startDate);
                const requestEnd = new Date(endDate);
                
                snapshot.forEach((childSnapshot) => {
                    const booking = childSnapshot.val();
                    if (booking.status !== 'cancelled') {
                        const bookingStart = new Date(booking.startDate);
                        const bookingEnd = new Date(booking.endDate);
                        
                        // Check for date overlap
                        if (requestStart <= bookingEnd && requestEnd >= bookingStart) {
                            isAvailable = false;
                        }
                    }
                });
                
                if (isAvailable) {
                    resultDiv.innerHTML = '<span class="text-green-600">‚úÖ Available for selected dates!</span>';
                    document.getElementById('proceedBookingBtn').disabled = false;
                } else {
                    resultDiv.innerHTML = '<span class="text-red-600">‚ùå Not available for selected dates</span>';
                    document.getElementById('proceedBookingBtn').disabled = true;
                }
            });
        }

        // Check location service
        function checkLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const userLat = position.coords.latitude;
                    const userLng = position.coords.longitude;
                    
                    let nearestCity = null;
                    let minDistance = Infinity;
                    
                    Object.entries(serviceAreas).forEach(([city, coords]) => {
                        const distance = calculateDistance(userLat, userLng, coords.lat, coords.lng);
                        if (distance < minDistance) {
                            minDistance = distance;
                            nearestCity = city;
                        }
                    });
                    
                    if (minDistance <= 50) { // Within 50km
                        alert(`‚úÖ Great! We serve your area. You're closest to our ${nearestCity} service area (${Math.round(minDistance)}km away).`);
                    } else {
                        alert(`‚ùå Sorry, you're outside our current service area. The nearest service area is ${nearestCity} (${Math.round(minDistance)}km away). Please contact us on WhatsApp for special arrangements.`);
                    }
                }, (error) => {
                    alert('Unable to get your location. Please select your city from the dropdown in the booking form.');
                });
            } else {
                alert('Geolocation is not supported by this browser. Please select your city from the dropdown in the booking form.');
            }
        }

        // Calculate distance between two points
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                    Math.sin(dLng/2) * Math.sin(dLng/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // Calculate price based on dates
        function calculatePrice() {
            const startDate = document.getElementById('checkStartDate').value;
            const endDate = document.getElementById('checkEndDate').value;
            const priceDiv = document.getElementById('priceCalculation');
            
            if (!startDate || !endDate || !currentCarDetail) {
                priceDiv.classList.add('hidden');
                return;
            }
            
            const start = new Date(startDate);
            const end = new Date(endDate);
            
            if (start >= end) {
                priceDiv.classList.add('hidden');
                return;
            }
            
            const timeDiff = end.getTime() - start.getTime();
            const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
            
            const dailyRate = currentCarDetail.dailyRate;
            const totalCost = daysDiff * dailyRate;
            
            // Update display
            document.getElementById('totalDays').textContent = daysDiff + ' days';
            document.getElementById('dailyRateDisplay').textContent = '‚Çπ' + dailyRate.toLocaleString();
            document.getElementById('totalCost').textContent = '‚Çπ' + totalCost.toLocaleString();
            
            priceDiv.classList.remove('hidden');
        }

        // Proceed to booking from detail modal
        function proceedToBooking() {
            if (!currentCarDetail) return;
            
            const startDate = document.getElementById('checkStartDate').value;
            const endDate = document.getElementById('checkEndDate').value;
            
            // Close modal
            closeCarDetail();
            
            // Pre-fill booking form
            document.getElementById('selectedCar').value = currentCarDetail.id;
            if (startDate) document.getElementById('startDate').value = startDate;
            if (endDate) document.getElementById('endDate').value = endDate;
            
            // Scroll to booking
            document.getElementById('booking').scrollIntoView({ behavior: 'smooth' });
        }

        // Select car for booking
        function selectCar(carId) {
            document.getElementById('selectedCar').value = carId;
            document.getElementById('booking').scrollIntoView({ behavior: 'smooth' });
        }

        // Handle form submission
        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const customerLocation = document.getElementById('customerLocation').value;
            
            // Check if location is in service area
            if (customerLocation === 'Other') {
                if (!confirm('You selected "Other" location. Our standard service areas are Banga, Jalandhar, Hoshiarpur, and Amritsar. Additional charges may apply for other locations. Do you want to continue?')) {
                    return;
                }
            }
            
            const formData = {
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                customerEmail: document.getElementById('customerEmail').value,
                customerLocation: customerLocation,
                selectedCar: document.getElementById('selectedCar').value,
                rentalPackage: document.getElementById('rentalPackage').value,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('endDate').value,
                additionalNotes: document.getElementById('additionalNotes').value,
                timestamp: new Date().toISOString(),
                status: 'pending'
            };

            // Check availability before booking
            const bookingsRef = database.ref('bookings');
            bookingsRef.orderByChild('selectedCar').equalTo(formData.selectedCar).once('value', (snapshot) => {
                let isAvailable = true;
                const requestStart = new Date(formData.startDate);
                const requestEnd = new Date(formData.endDate);
                
                snapshot.forEach((childSnapshot) => {
                    const booking = childSnapshot.val();
                    if (booking.status !== 'cancelled') {
                        const bookingStart = new Date(booking.startDate);
                        const bookingEnd = new Date(booking.endDate);
                        
                        // Check for date overlap
                        if (requestStart <= bookingEnd && requestEnd >= bookingStart) {
                            isAvailable = false;
                        }
                    }
                });
                
                if (!isAvailable) {
                    alert('Sorry, this vehicle is not available for the selected dates. Please choose different dates or another vehicle.');
                    return;
                }
                
                // Save to Firebase if available
                const newBookingRef = database.ref('bookings').push();
                newBookingRef.set(formData)
                    .then(() => {
                        showSuccessModal();
                        document.getElementById('bookingForm').reset();
                    })
                    .catch((error) => {
                        alert('Error submitting booking: ' + error.message);
                    });
            });
        });

        // Show success modal
        function showSuccessModal() {
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
        }

        // Close modal
        function closeModal() {
            document.getElementById('successModal').classList.add('hidden');
            document.getElementById('successModal').classList.remove('flex');
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Set minimum date to today
        document.getElementById('startDate').min = new Date().toISOString().split('T')[0];
        document.getElementById('endDate').min = new Date().toISOString().split('T')[0];

        // Update end date when start date changes
        document.getElementById('startDate').addEventListener('change', function() {
            document.getElementById('endDate').min = this.value;
        });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadCars();
            loadPricingTable();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98d4f06c232e59ee',t:'MTc2MDI1NDcyMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
